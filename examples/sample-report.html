<!DOCTYPE html>
<html>
<head>
    <title>Lambda Power Tuning Report - api-handler</title>
    <meta charset="utf-8">
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header { text-align: center; border-bottom: 2px solid #007acc; padding-bottom: 20px; margin-bottom: 30px; }
        .header h1 { color: #007acc; margin: 0; }
        .header p { color: #666; margin: 5px 0; }
        .summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .summary-card { background: #f8f9fa; padding: 20px; border-radius: 6px; text-align: center; }
        .summary-card h3 { margin: 0 0 10px 0; color: #007acc; }
        .summary-card .value { font-size: 1.5em; font-weight: bold; color: #333; }
        .recommendation { background: #e8f5e8; padding: 20px; border-radius: 6px; margin-bottom: 30px; border-left: 4px solid #28a745; }
        .recommendation h3 { margin-top: 0; color: #28a745; }
        .results-table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
        .results-table th, .results-table td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        .results-table th { background: #007acc; color: white; }
        .results-table tr:nth-child(even) { background: #f8f9fa; }
        .optimal { background: #d4edda !important; font-weight: bold; }
        .chart-container { margin: 30px 0; text-align: center; }
        .chart { width: 100%; max-width: 800px; height: 400px; margin: 0 auto; }
        .chart-title { font-size: 1.2em; font-weight: bold; color: #333; margin-bottom: 15px; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Lambda Power Tuning Report</h1>
            <p><strong>Function:</strong> api-handler</p>
            <p><strong>Generated:</strong> June 6, 2025, 2:30 PM</p>
            <p><strong>Duration:</strong> 2.3 minutes</p>
            <p><strong>Strategy:</strong> Balanced</p>
        </div>

        <div class="summary">
            <div class="summary-card">
                <h3>Current Memory</h3>
                <div class="value">512MB</div>
            </div>
            <div class="summary-card">
                <h3>üéØ Optimal Memory</h3>
                <div class="value">1024MB</div>
            </div>
            <div class="summary-card">
                <h3>üí∞ Cost Savings</h3>
                <div class="value">-12%</div>
            </div>
            <div class="summary-card">
                <h3>‚ö° Speed Improvement</h3>
                <div class="value">+45%</div>
            </div>
        </div>

        <div class="recommendation">
            <h3>üéØ Optimization Recommendation</h3>
            <p><strong>Strategy:</strong> Balanced</p>
            <p><strong>Action:</strong> Increase memory from 512MB to 1024MB</p>
            <p><strong>Impact:</strong> This change will reduce execution time by 45% while increasing cost by only 12%, resulting in better overall efficiency and user experience for your API function.</p>
            <p><strong>Monthly Savings:</strong> Estimated $24.50/month for 1M invocations</p>
        </div>

        <h2>üìä Performance Results</h2>
        <table class="results-table">
            <thead>
                <tr>
                    <th>Memory (MB)</th>
                    <th>Avg Duration (ms)</th>
                    <th>Avg Cost ($)</th>
                    <th>Cold Starts</th>
                    <th>P95 Duration (ms)</th>
                    <th>Success Rate</th>
                    <th>Efficiency Score</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>256</td>
                    <td>2,456</td>
                    <td>0.000052</td>
                    <td>2</td>
                    <td>2,890</td>
                    <td>100%</td>
                    <td>2.51</td>
                </tr>
                <tr class="optimal">
                    <td>512</td>
                    <td>1,234</td>
                    <td>0.000056</td>
                    <td>1</td>
                    <td>1,456</td>
                    <td>100%</td>
                    <td>1.29</td>
                </tr>
                <tr style="background: #d1ecf1 !important; font-weight: bold;">
                    <td>1024 ‚≠ê</td>
                    <td>678</td>
                    <td>0.000063</td>
                    <td>1</td>
                    <td>789</td>
                    <td>100%</td>
                    <td>0.74</td>
                </tr>
                <tr>
                    <td>2048</td>
                    <td>456</td>
                    <td>0.000089</td>
                    <td>0</td>
                    <td>523</td>
                    <td>100%</td>
                    <td>0.54</td>
                </tr>
                <tr>
                    <td>3008</td>
                    <td>398</td>
                    <td>0.000134</td>
                    <td>0</td>
                    <td>445</td>
                    <td>100%</td>
                    <td>0.53</td>
                </tr>
            </tbody>
        </table>

        <div class="chart-container">
            <div class="chart-title">‚ö° Execution Time vs Memory</div>
            <canvas id="durationChart" class="chart"></canvas>
        </div>

        <div class="chart-container">
            <div class="chart-title">üí∞ Cost vs Memory</div>
            <canvas id="costChart" class="chart"></canvas>
        </div>

        <div class="chart-container">
            <div class="chart-title">üéØ Efficiency Score vs Memory</div>
            <canvas id="efficiencyChart" class="chart"></canvas>
        </div>

        <h2>üìà Key Insights</h2>
        <div style="background: #f8f9fa; padding: 20px; border-radius: 6px; margin: 20px 0;">
            <ul style="margin: 0; padding-left: 20px;">
                <li><strong>Sweet Spot:</strong> 1024MB provides the best balance of cost and performance</li>
                <li><strong>Performance Gain:</strong> Doubling memory from 512MB to 1024MB nearly halves execution time</li>
                <li><strong>Cost Impact:</strong> The 12% cost increase is justified by 45% performance improvement</li>
                <li><strong>Cold Starts:</strong> Minimal impact across all memory configurations</li>
                <li><strong>Scalability:</strong> Higher memory configurations show diminishing returns</li>
            </ul>
        </div>

        <h2>üìä Historical Trends</h2>
        <div style="background: #fff3cd; padding: 15px; border-radius: 6px; border-left: 4px solid #ffc107;">
            <p><strong>üí° Tip:</strong> This is your first tuning run! Run this tool regularly to track performance changes over time as your function evolves.</p>
        </div>

        <hr style="margin: 40px 0; border: none; border-top: 1px solid #ddd;">
        
        <div style="text-align: center; color: #666; font-size: 0.9em;">
            <p>Generated by Universal Lambda Power Tuner | <a href="https://github.com/kencytbb/universal-serverless-tuner">View on GitHub</a></p>
        </div>
    </div>

    <script>
        // Sample data - this would be generated dynamically
        const memoryData = [256, 512, 1024, 2048, 3008];
        const durationData = [2456, 1234, 678, 456, 398];
        const costData = [0.000052, 0.000056, 0.000063, 0.000089, 0.000134];
        const efficiencyData = [2.51, 1.29, 0.74, 0.54, 0.53];

        // Duration Chart
        new Chart(document.getElementById('durationChart'), {
            type: 'line',
            data: {
                labels: memoryData.map(m => m + 'MB'),
                datasets: [{
                    label: 'Average Duration (ms)',
                    data: durationData,
                    borderColor: '#007acc',
                    backgroundColor: 'rgba(0, 122, 204, 0.1)',
                    tension: 0.4,
                    pointBackgroundColor: '#007acc',
                    pointBorderColor: '#007acc',
                    pointBorderWidth: 2,
                    pointRadius: 6
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Duration (ms)',
                            font: { size: 14, weight: 'bold' }
                        },
                        grid: {
                            color: 'rgba(0,0,0,0.1)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Memory Configuration',
                            font: { size: 14, weight: 'bold' }
                        }
                    }
                }
            }
        });

        // Cost Chart
        new Chart(document.getElementById('costChart'), {
            type: 'line',
            data: {
                labels: memoryData.map(m => m + 'MB'),
                datasets: [{
                    label: 'Average Cost ($)',
                    data: costData,
                    borderColor: '#28a745',
                    backgroundColor: 'rgba(40, 167, 69, 0.1)',
                    tension: 0.4,
                    pointBackgroundColor: '#28a745',
                    pointBorderColor: '#28a745',
                    pointBorderWidth: 2,
                    pointRadius: 6
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Cost per Invocation ($)',
                            font: { size: 14, weight: 'bold' }
                        },
                        ticks: {
                            callback: function(value) {
                                return '$' + value.toFixed(6);
                            }
                        },
                        grid: {
                            color: 'rgba(0,0,0,0.1)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Memory Configuration',
                            font: { size: 14, weight: 'bold' }
                        }
                    }
                }
            }
        });

        // Efficiency Chart
        new Chart(document.getElementById('efficiencyChart'), {
            type: 'bar',
            data: {
                labels: memoryData.map(m => m + 'MB'),
                datasets: [{
                    label: 'Efficiency Score (lower is better)',
                    data: efficiencyData,
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.8)',
                        'rgba(255, 159, 64, 0.8)',
                        'rgba(75, 192, 192, 0.8)', // Best
                        'rgba(153, 102, 255, 0.8)',
                        'rgba(255, 205, 86, 0.8)'
                    ],
                    borderColor: [
                        'rgb(255, 99, 132)',
                        'rgb(255, 159, 64)',
                        'rgb(75, 192, 192)',
                        'rgb(153, 102, 255)',
                        'rgb(255, 205, 86)'
                    ],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Efficiency Score',
                            font: { size: 14, weight: 'bold' }
                        },
                        grid: {
                            color: 'rgba(0,0,0,0.1)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Memory Configuration',
                            font: { size: 14, weight: 'bold' }
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>